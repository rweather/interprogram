enable_testing()

set(EXAMPLE_DIR ${CMAKE_SOURCE_DIR}/examples)

# Verify that the classic examples only use classic-compatible characters.
add_test(NAME verify_3dplot COMMAND interprogram --verify-chars ${EXAMPLE_DIR}/classic/3dplot.ip)
add_test(NAME verify_hello_world COMMAND interprogram --verify-chars ${EXAMPLE_DIR}/classic/hello_world.ip)
add_test(NAME verify_matches COMMAND interprogram --verify-chars ${EXAMPLE_DIR}/classic/matches.ip)
add_test(NAME verify_pythagoras COMMAND interprogram --verify-chars ${EXAMPLE_DIR}/classic/pythagoras.ip)
add_test(NAME verify_sinewave COMMAND interprogram --verify-chars ${EXAMPLE_DIR}/classic/sinewave.ip)
add_test(NAME verify_example1 COMMAND interprogram --verify-chars ${EXAMPLE_DIR}/manual/example1.ip)
add_test(NAME verify_example2 COMMAND interprogram --verify-chars ${EXAMPLE_DIR}/manual/example2.ip)
add_test(NAME verify_example2a COMMAND interprogram --verify-chars ${EXAMPLE_DIR}/manual/example2a.ip)
add_test(NAME verify_example3 COMMAND interprogram --verify-chars ${EXAMPLE_DIR}/manual/example3.ip)
add_test(NAME verify_example4 COMMAND interprogram --verify-chars ${EXAMPLE_DIR}/manual/example4.ip)

# Verify that all examples can be parsed.  Catches regressions in parser
# behaviour as new features are added to the language.
add_test(NAME parse_classic_3dplot COMMAND interprogram --parse-only ${EXAMPLE_DIR}/classic/3dplot.ip)
add_test(NAME parse_classic_hello_world COMMAND interprogram --parse-only ${EXAMPLE_DIR}/classic/hello_world.ip)
add_test(NAME parse_classic_matches COMMAND interprogram --parse-only ${EXAMPLE_DIR}/classic/matches.ip)
add_test(NAME parse_classic_pythagoras COMMAND interprogram --parse-only ${EXAMPLE_DIR}/classic/pythagoras.ip)
add_test(NAME parse_classic_sinewave COMMAND interprogram --parse-only ${EXAMPLE_DIR}/classic/sinewave.ip)
add_test(NAME parse_extended_3dplot COMMAND interprogram --parse-only ${EXAMPLE_DIR}/extended/3dplot.ip)
add_test(NAME parse_extended_dice COMMAND interprogram --parse-only ${EXAMPLE_DIR}/extended/dice.ip)
add_test(NAME parse_extended_hello_world COMMAND interprogram --parse-only ${EXAMPLE_DIR}/extended/hello_world.ip)
add_test(NAME parse_extended_matches COMMAND interprogram --parse-only ${EXAMPLE_DIR}/extended/matches.ip)
add_test(NAME parse_extended_pythagoras COMMAND interprogram --parse-only ${EXAMPLE_DIR}/extended/pythagoras.ip)
add_test(NAME parse_extended_sinewave COMMAND interprogram --parse-only ${EXAMPLE_DIR}/extended/sinewave.ip)
add_test(NAME parse_manual_example1 COMMAND interprogram --parse-only ${EXAMPLE_DIR}/manual/example1.ip)
add_test(NAME parse_manual_example2 COMMAND interprogram --parse-only ${EXAMPLE_DIR}/manual/example2.ip)
add_test(NAME parse_manual_example2a COMMAND interprogram --parse-only ${EXAMPLE_DIR}/manual/example2a.ip)
add_test(NAME parse_manual_example3 COMMAND interprogram --parse-only ${EXAMPLE_DIR}/manual/example3.ip)
add_test(NAME parse_manual_example4 COMMAND interprogram --parse-only ${EXAMPLE_DIR}/manual/example4.ip)

# Run some programs to test the interpreter's functionality.
add_test(NAME arrays COMMAND interprogram ${CMAKE_CURRENT_LIST_DIR}/arrays.ip)
add_test(NAME conditions COMMAND interprogram ${CMAKE_CURRENT_LIST_DIR}/conditions.ip)
add_test(NAME control_flow1 COMMAND interprogram ${CMAKE_CURRENT_LIST_DIR}/control_flow1.ip)
add_test(NAME control_flow2 COMMAND interprogram ${CMAKE_CURRENT_LIST_DIR}/control_flow2.ip)
add_test(NAME input COMMAND interprogram ${CMAKE_CURRENT_LIST_DIR}/input.ip)
add_test(NAME math1 COMMAND interprogram ${CMAKE_CURRENT_LIST_DIR}/math1.ip)
add_test(NAME math2 COMMAND interprogram ${CMAKE_CURRENT_LIST_DIR}/math2.ip)
add_test(NAME math3 COMMAND interprogram ${CMAKE_CURRENT_LIST_DIR}/math3.ip)
add_test(NAME math4 COMMAND interprogram ${CMAKE_CURRENT_LIST_DIR}/math4.ip)
add_test(NAME math5 COMMAND interprogram ${CMAKE_CURRENT_LIST_DIR}/math5.ip)
add_test(NAME routines COMMAND interprogram ${CMAKE_CURRENT_LIST_DIR}/routines.ip)
add_test(NAME strings COMMAND interprogram ${CMAKE_CURRENT_LIST_DIR}/strings.ip First Second Third)
